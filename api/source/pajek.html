<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">var reader   = require(&#39;./line-reader&#39;);
var Graph    = require(&#39;../util/graph&#39;);

function lineParser(network) {
    var parseMode = null;
    var vertexMode = new RegExp(/^\*\s*vertices/i);
    var edgeMode   = new RegExp(/^\*\s*(?:edges|arcs)/i);
    return function (line) {
        line = line.replace(/^\s+|\s+$|[&quot;&#39;]/g, &#39;&#39;);
        if (line == &#39;&#39;) return;
        if (vertexMode.test(line)) {
            parseMode = &#39;vertices&#39;;
            return;
        }
        if (edgeMode.test(line)) {
            parseMode = &#39;edges&#39;;
            return;
        }
        var tokens = line.split(/\s+/);
        if (parseMode == &#39;vertices&#39;) {
            network.addNode(tokens[0]).attribute(&#39;name&#39;, tokens[1]);
        } else if (parseMode == &#39;edges&#39;) {
            network.link(tokens[0], tokens[1], { weight: tokens[2] });
        }
    }
}


exports.parse = function (filename, callback) {
    var network = new Graph();
    var stream = reader(filename);
    stream.on(&#39;line&#39;, lineParser(network));
    stream.on(&#39;end&#39;, function () {
        callback(network);
    })
};</pre>
</body>
</html>
