<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">var reader   = require('./line-reader');
var Graph    = require('../graph');

function lineParser(network) {
    var parseMode = null;
    var vertexMode = new RegExp(/^\*\s*vertices/i);
    var edgeMode   = new RegExp(/^\*\s*(?:edges|arcs)/i);
    return function (line) {
        line = line.replace(/^\s+|\s+$|[&quot;']/g, '');
        if (line == '') return;
        if (vertexMode.test(line)) {
            parseMode = 'vertices';
            return;
        }
        if (edgeMode.test(line)) {
            parseMode = 'edges';
            return;
        }
        var tokens = line.split(/\s+/);
        if (parseMode == 'vertices') {
            network.addNode(tokens[0]).attribute('name', tokens[1]);
        } else if (parseMode == 'edges') {
            network.link(tokens[0], tokens[1], { weight: tokens[2] });
        }
    }
}


exports.parse = function (filename, callback) {
    var network = new Graph();
    var stream = reader(filename);
    stream.on('line', lineParser(network));
    stream.on('end', function () {
        callback(network);
    })
};</pre>
</body>
</html>
